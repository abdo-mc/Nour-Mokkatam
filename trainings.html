<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>التدريبات - مركز شباب نور المقطم</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo&display=swap" rel="stylesheet" />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    crossorigin="anonymous"
  />
  <style>
    /* هنا تضع كل الـ CSS الموجود */
  </style>
</head>
<body>
  <header>
    <img src="https://drive.google.com/uc?export=view&id=1kgHdRe8f6Lwi-x12GFzEGVO7XVr6PQsB" alt="وزارة الشباب والرياضة" />
    <img src="https://drive.google.com/uc?export=view&id=19ArNiOiblQdq0vIfGXWP4u1w1fZu_UWF" alt="مركز شباب نور المقطم" />
  </header>

  <div class="container">
    <div class="title-container">
      <h1>التدريبات</h1>
      <div class="subtitle">جميع الألعاب المتاحة</div>
    </div>

    <button class="btn-back" onclick="location.href='Main.html'">
      <i class="fa-solid fa-arrow-right-from-bracket"></i> العودة للصفحة الرئيسية
    </button>

    <div class="training-list" id="trainingList">
      <p>جاري تحميل البيانات...</p>
    </div>
  </div>

  <script>
    // رابط API الجديد الذي يعمل
    const apiUrl = "https://script.google.com/macros/s/AKfycbywMLxJT_xBYoFCdSglMuCIVATe-qcu3m5x3t64fIza/dev?action=getTrainings";

    const trainingList = document.getElementById('trainingList');

    function createTrainingCard(training) {
      const ulDays = training.days.map(day => `<li>${day.day}: من ${day.from} إلى ${day.to}</li>`).join('');
      return `
        <div class="training-card">
          <h3>اللعبة: ${training.game}</h3>
          <p><strong>الأكاديمية:</strong> ${training.academy}</p>
          <p><strong>سعر التدريب:</strong> ${training.price} جنيه</p>
          <p><strong>رقم الكابتن:</strong> ${training.coach}</p>
          <p><strong>المواعيد:</strong></p>
          <ul>${ulDays}</ul>
        </div>
      `;
    }

    async function fetchTrainings() {
      try {
        const res = await fetch(apiUrl);
        if (!res.ok) throw new Error('حدث خطأ في جلب البيانات');
        const data = await res.json();

        if (!data.length) {
          trainingList.innerHTML = "<p>لا توجد بيانات لعرضها حالياً.</p>";
          return;
        }

        // تنسيق البيانات: افترض إن البيانات عندك فيها الأعمدة: 
        // "اللعبه", "الاكاديمية", "سعر التدريب", "رقم الكابتن", "اليوم", "من", "الي"
        // لازم نجمّع كل مواعيد اليوم المختلفة لكل لعبة وأكاديمية مع بعض

        const trainingsMap = new Map();

        data.forEach(item => {
          const key = item["اللعبه"] + "||" + item["الاكاديمية"];
          if (!trainingsMap.has(key)) {
            trainingsMap.set(key, {
              game: item["اللعبه"],
              academy: item["الاكاديمية"],
              price: item["سعر التدريب"],
              coach: item["رقم الكابتن"],
              days: []
            });
          }
          trainingsMap.get(key).days.push({
            day: item["اليوم"],
            from: item["من"],
            to: item["إلى"]
          });
        });

        const htmlCards = Array.from(trainingsMap.values()).map(createTrainingCard).join('');
        trainingList.innerHTML = htmlCards;

      } catch (error) {
        console.error(error);
        trainingList.innerHTML = "<p>حدث خطأ في تحميل البيانات، يرجى المحاولة لاحقاً.</p>";
      }
    }

    fetchTrainings();
  </script>
</body>
</html>
