<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>التدريبات - مركز شباب نور المقطم</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo&display=swap" rel="stylesheet" />
  <style>
    /* نفس التنسيقات السابقة */
    /* ... */
  </style>
</head>
<body>
  <div class="container">
    <div class="title-container">
      <h1>التدريبات</h1>
      <div class="subtitle">جميع الألعاب المتاحة</div>
    </div>

    <button class="btn-back" onclick="location.href='Main.html'">
      &#8592; العودة للصفحة الرئيسية
    </button>

    <div class="training-list" id="trainingList">
      <p>جاري تحميل البيانات...</p>
    </div>
  </div>

  <script>
    const apiUrl = "https://script.google.com/macros/s/AKfycbzcE_1OfbFq5hFr8Vm1KQ_JyyCviT9J6ni1WUzX6VCcbViBGwkK47kDVaILKs41Ayz3cw/exec";

    const trainingList = document.getElementById('trainingList');

    function createTrainingCard(training) {
      let daysHtml = '';
      if (Array.isArray(training.days)) {
        daysHtml = training.days.map(day => `<li>${day.day}: من ${day.from} إلى ${day.to}</li>`).join('');
      }
      return `
        <div class="training-card">
          <h3>اللعبة: ${training.game}</h3>
          <p><strong>الأكاديمية:</strong> ${training.academy}</p>
          <p><strong>سعر التدريب:</strong> ${training.price} جنيه</p>
          <p><strong>رقم الكابتن:</strong> ${training.coach}</p>
          <p><strong>المواعيد:</strong></p>
          <ul>${daysHtml}</ul>
        </div>
      `;
    }

    async function fetchTrainings() {
      try {
        const res = await fetch(apiUrl);
        if (!res.ok) throw new Error('حدث خطأ في جلب البيانات');
        const data = await res.json();

        if (!data.length) {
          trainingList.innerHTML = "<p>لا توجد بيانات لعرضها حالياً.</p>";
          return;
        }

        const trainingsMap = new Map();

        data.forEach(item => {
          const key = item["اللعبة"] + "||" + item["الأكاديمية"];
          if (!trainingsMap.has(key)) {
            trainingsMap.set(key, {
              game: item["اللعبة"],
              academy: item["الأكاديمية"],
              price: item["سعر التدريب"],
              coach: item["رقم الكابتن"],
              days: []
            });
          }
          trainingsMap.get(key).days.push({
            day: item["اليوم"],
            from: item["من"],
            to: item["إلى"]
          });
        });

        const htmlCards = Array.from(trainingsMap.values()).map(createTrainingCard).join('');
        trainingList.innerHTML = htmlCards;

      } catch (error) {
        console.error(error);
        trainingList.innerHTML = "<p>حدث خطأ في تحميل البيانات، يرجى المحاولة لاحقاً.</p>";
      }
    }

    fetchTrainings();
  </script>
</body>
</html>
